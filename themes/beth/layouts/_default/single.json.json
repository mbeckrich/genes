{{- $name := findRE `(?mi)^[0-9]+\.\s+([^.])+` .RawContent -}}
{{- $bday := findRE `(?mi)\d\d\d\d\-\d\d-\d\d` .RawContent -}}
{{- $children := findRE `(?mi)^\s+[i, ii, iii, vi, v, vi, vii, viii, ix, x]+\.\s+([^.])+` .RawContent -}}

{{- $counter := 0 -}}
{
    "version": "https://jsonfeed.org/version/1",
    "title": "{{ .Site.Title }}",
        "author": {
            "name": "{{ .Site.Params.author }}"
        },
{{- range where .Site.RegularPages ".Type" "ahnentafel" -}}

    {{- range $k, $v := $name -}}
        {{- $generation := (math.Floor (div (math.Log ($counter = add $counter 1)) (math.Log 2))) -}}

        {{- $id := $counter -}}

          {{- if lt $k 9 -}}
          {{- $id = print "-00" $id -}}
          {{- else -}}
          {{- $id = print "-0" $id -}}
          {{- end -}}

        {{- $generation = string $generation -}}
        {{- $id := print "[0" $generation print $id "]" -}}

        {{- $names := replaceRE `[0-9.]+\s+` "" $v -}}
        {{ $names := replaceRE `\\` "\\\\" $names }}

    "{{- $id -}}": [
    {
        "name": "{{- string $names -}}",
        "date of birth": "{{- index $bday $k -}}",
        "place of birth": "",
        "date of death": "",
        "place of death": "",
        {{- if (and (modBool $k 2) (ne $id "[00-001]")) }}
        "children": "{{- index $children }}"
        {{ end }}
    }
    {{- if eq $counter (len $name) -}}
    ]
    {{- else -}}
    ],
    {{ end }}
    {{ end }}
{{ end }}
}